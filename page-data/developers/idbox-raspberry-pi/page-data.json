{"componentChunkName":"component---node-modules-confluenza-gatsby-theme-confluenza-src-templates-markdown-template-js","path":"/developers/idbox-raspberry-pi","result":{"data":{"site":{"siteMetadata":{"title":"Identity Box","editBaseUrl":"https://github.com/identity-box/identity-box/blob/master"}},"config":{"nodes":[{"tag":"user","title":"Identity Box"},{"tag":"developer","title":"Developers"},{"tag":"beta","title":"Early Adopters"},{"tag":"component","title":"Components"},{"tag":"service","title":"Services"},{"tag":"utils","title":"Utils"}]},"doc":{"html":"<p>RaspberryPi is a reliable, powerful, and cost-effective platform that can be used to run Identity Box. In this document we describe how to setup a an Identity Box on Raspberry Pi. We will be using <a href=\"https://www.raspberrypi.org/products/raspberry-pi-4-model-b/\">Raspberry Pi 4</a> with 4GB RAM. Please follow the standard instructions at <a href=\"https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up\">Setting up your Raspberry Pi</a> and make sure you <a href=\"https://www.raspberrypi.org/documentation/remote-access/ssh/\">enable ssh access</a>. <a href=\"https://www.raspberrypi.org/downloads/raspbian/\">Raspbian</a> comes with git already installed.</p>\n<h2 id=\"install-nodejs-and-yarn\" style=\"position:relative;\"><a href=\"#install-nodejs-and-yarn\" aria-label=\"install nodejs and yarn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install Node.js and yarn</h2>\n<p>We currently use Node v16 LTS. We recommend using <a href=\"https://github.com/nvm-sh/nvm\">Node Version Manager</a>. To install Node Version Manager (nvm) on your Raspberry run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">curl</span> -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh <span class=\"token operator\">|</span> <span class=\"token function\">bash</span></code></pre></div>\n<p>Then install Node 16 LTS:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ nvm <span class=\"token function\">install</span> --lts</code></pre></div>\n<p>Let's also install <a href=\"https://yarnpkg.com/getting-started/install\">yarn</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ corepack <span class=\"token builtin class-name\">enable</span></code></pre></div>\n<p>Everything should be in place now. At the time of writing of this document we had:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">node</span> --version\nv16.16.0\n$ <span class=\"token function\">yarn</span> --version\n<span class=\"token number\">1.22</span>.15\n$ <span class=\"token function\">git</span> --version\n<span class=\"token function\">git</span> version <span class=\"token number\">2.25</span>.1</code></pre></div>\n<h2 id=\"install-ipfs\" style=\"position:relative;\"><a href=\"#install-ipfs\" aria-label=\"install ipfs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install IPFS</h2>\n<p>We will use <a href=\"https://github.com/claudiobizzotto/ipfs-rpi\">IPFS installer</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">git</span> clone https://github.com/claudiobizzotto/ipfs-rpi.git</code></pre></div>\n<p>We install IPFS v0.14.0</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ipfs-rpi/\n$ ./install v0.14.0</code></pre></div>\n<p>This will install, initialize, and start IPFS. We need to alter configuration a bit, so let's stop IPFS for the moment:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> systemctl stop ipfs-daemon.service</code></pre></div>\n<p>The <code class=\"language-text\">ipfs-deamon.service</code> uses <code class=\"language-text\">/usr/local/bin/ipfs daemon --migrate</code> to start ipfs. For our Identity Box, we need\na different startup command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/usr/local/bin/ipfs daemon --enable-namesys-pubsub --enable-pubsub-experiment --enable-gc --migrate</code></pre></div>\n<p>You can change it using:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ipfs-rpi/\n$ <span class=\"token function\">nano</span> templates/ipfs-daemon.service.tpl</code></pre></div>\n<p>and change set:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/local/bin/ipfs daemon --enable-namesys-pubsub --enable-pubsub-experiment --enable-gc --migrate</code></pre></div>\n<p>Notice, however, that in order for the changes to take effect, you will need to stop the daemon and run installation script again: <code class=\"language-text\">./install v0.14.0</code>.</p>\n<p>So after changing the template file, we run again:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ipfs-rpi/\n$ ./install v0.14.0\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> Starting IPFS\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> All done.</code></pre></div>\n<p>We also need to change the configuration of our IPFS node. IPFS configuration can be found in <code class=\"language-text\">~/.ipfs/config</code>. While the daemon is stopped, we can edit this file:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">nano</span> ~/.ipfs/config</code></pre></div>\n<p>We first disable the gateway:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"Addresses\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"Swarm\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"/ip4/0.0.0.0/tcp/4001\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/ip6/::/tcp/4001\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/ip4/0.0.0.0/udp/4001/quic\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/ip6/::/udp/4001/quic\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Announce\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"AppendAnnounce\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"NoAnnounce\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"API\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/ip4/127.0.0.1/tcp/5001\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Gateway\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Then we limit the maximum size of file storage to <code class=\"language-text\">5GB</code> (default is <code class=\"language-text\">10G</code>):</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"Datastore\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"StorageMax\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"5GB\"</span><span class=\"token punctuation\">,</span></code></pre></div>\n<blockquote>\n<p>You may skip that if you have hardware with more storage available.</p>\n</blockquote>\n<p>We change the <code class=\"language-text\">MDNS</code> discovery:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"Discovery\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"MDNS\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Enabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Interval\"</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>and finally in <code class=\"language-text\">Swarm</code> section:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"Swarm\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"AddrFilters\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"DisableBandwidthMetrics\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"DisableNatPortMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"RelayClient\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"RelayService\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Transports\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Network\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Security\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Multiplexers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"ConnMgr\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"basic\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"LowWater\"</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"HighWater\"</span><span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"GracePeriod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"20s\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>For reference, below is the whole <code class=\"language-text\">~/.ipfs/config</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"Identity\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"PeerID\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;...>\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"PrivKey\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;...>\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Datastore\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"StorageMax\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"10GB\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"StorageGCWatermark\"</span><span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"GCPeriod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1h\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Spec\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"mounts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"child\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"blocks\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"shardFunc\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/repo/flatfs/shard/v1/next-to-last/2\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"sync\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"flatfs\"</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"mountpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/blocks\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"flatfs.datastore\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"measure\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"child\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"compression\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"none\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"path\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"datastore\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"levelds\"</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"mountpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"prefix\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"leveldb.datastore\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"measure\"</span>\n        <span class=\"token punctuation\">}</span>\n\t      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"mount\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"HashOnRead\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"BloomFilterSize\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Addresses\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Swarm\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"/ip4/0.0.0.0/tcp/4001\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"/ip6/::/tcp/4001\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"/ip4/0.0.0.0/udp/4001/quic\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"/ip6/::/udp/4001/quic\"</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Announce\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"AppendAnnounce\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"NoAnnounce\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"API\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/ip4/127.0.0.1/tcp/5001\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Gateway\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Mounts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"IPFS\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/ipfs\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"IPNS\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/ipns\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"FuseAllowOther\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Discovery\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"MDNS\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Enabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Routing\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dht\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Routers\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Ipns\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"RepublishPeriod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"RecordLifetime\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ResolveCacheSize\"</span><span class=\"token operator\">:</span> <span class=\"token number\">128</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Bootstrap\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/ip4/104.131.131.82/tcp/4001/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/ip4/104.131.131.82/udp/4001/quic/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Gateway\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"HTTPHeaders\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Access-Control-Allow-Headers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"X-Requested-With\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"Range\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"User-Agent\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Access-Control-Allow-Methods\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"GET\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Access-Control-Allow-Origin\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"*\"</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"RootRedirect\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Writable\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"PathPrefixes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"APICommands\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"NoFetch\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"NoDNSLink\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"PublicGateways\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"API\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"HTTPHeaders\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Swarm\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"AddrFilters\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"DisableBandwidthMetrics\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"DisableNatPortMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"RelayClient\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"RelayService\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Transports\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Network\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Security\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Multiplexers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ConnMgr\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"basic\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"LowWater\"</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"HighWater\"</span><span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"GracePeriod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"20s\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ResourceMgr\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"AutoNAT\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Pubsub\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Router\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"DisableSigning\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Peering\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Peers\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"DNS\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Resolvers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Migration\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"DownloadSources\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Keep\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Provider\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Strategy\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Reprovider\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Interval\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"12h\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Strategy\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"all\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Experimental\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"FilestoreEnabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"UrlstoreEnabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"GraphsyncEnabled\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Libp2pStreamMounting\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"P2pHttpProxy\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"StrategicProviding\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"AcceleratedDHTClient\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Plugins\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Pinning\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"RemoteServices\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Internal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Also make sure you open port <code class=\"language-text\">4001</code> and map it to your Identity Box IP address so that it is accessible from outside. For this please refer to your ISP router settings.</p>\n<p>Finally, create <code class=\"language-text\">~/.bash_profile</code> and add the following to it:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">IPFS_PATH</span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/.ipfs\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -n <span class=\"token string\">\"<span class=\"token environment constant\">$BASH_VERSION</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n    <span class=\"token comment\"># include .bashrc if it exists</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -f <span class=\"token string\">\"<span class=\"token environment constant\">$HOME</span>/.bashrc\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n        <span class=\"token builtin class-name\">.</span> <span class=\"token string\">\"<span class=\"token environment constant\">$HOME</span>/.bashrc\"</span>\n    <span class=\"token keyword\">fi</span>\n<span class=\"token keyword\">fi</span></code></pre></div>\n<p>Log out and log in again, check that <code class=\"language-text\">$IPFS_PATH</code> is set, and start IPFS service:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$IPFS_PATH</span>\n/home/pi/.ipfs\n$ <span class=\"token function\">sudo</span> systemctl start ipfs-daemon.service</code></pre></div>\n<p>Check the configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ ipfs config show</code></pre></div>\n<p>You can check the status and see how much memory your IPFS is using by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> systemctl status ipfs-daemon.service\n● ipfs-daemon.service - IPFS daemon\n   Loaded: loaded <span class=\"token punctuation\">(</span>/lib/systemd/system/ipfs-daemon.service<span class=\"token punctuation\">;</span> enabled<span class=\"token punctuation\">;</span> vendor preset: enabled<span class=\"token punctuation\">)</span>\n   Active: active <span class=\"token punctuation\">(</span>running<span class=\"token punctuation\">)</span> since Fri <span class=\"token number\">2022</span>-01-14 02:28:45 CET<span class=\"token punctuation\">;</span> 20s ago\n Main PID: <span class=\"token number\">517</span> <span class=\"token punctuation\">(</span>ipfs<span class=\"token punctuation\">)</span>\n    Tasks: <span class=\"token number\">10</span> <span class=\"token punctuation\">(</span>limit: <span class=\"token number\">4915</span><span class=\"token punctuation\">)</span>\n   Memory: <span class=\"token number\">87</span>.9M\n   CGroup: /system.slice/ipfs-daemon.service\n           └─517 /usr/local/bin/ipfs daemon --enable-namesys-pubsub --enable-pubsub-experiment --enable-gc --migrate\n\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Swarm listening on /ip6/::1/tcp/4001\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Swarm listening on /ip6/::1/udp/4001/quic\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Swarm listening on /p2p-circuit\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Swarm announcing /ip4/127.0.0.1/tcp/4001\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Swarm announcing /ip4/127.0.0.1/udp/4001/quic\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Swarm announcing /ip6/::1/tcp/4001\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Swarm announcing /ip6/::1/udp/4001/quic\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: API server listening on /ip4/127.0.0.1/tcp/5001\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: WebUI: http://127.0.0.1:5001/webui\nJan <span class=\"token number\">14</span> 02:28:48 idbox-1-new ipfs<span class=\"token punctuation\">[</span><span class=\"token number\">517</span><span class=\"token punctuation\">]</span>: Daemon is ready</code></pre></div>\n<blockquote>\n<p>if you do not see the <code class=\"language-text\">Memory</code> entry above, you may need to add</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">cgroup_enable</span><span class=\"token operator\">=</span>memory <span class=\"token assign-left variable\">cgroup_memory</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></code></pre></div>\n<p>to <code class=\"language-text\">/boot/cmdline.txt</code> and restart your box with <code class=\"language-text\">sudo shutdown -r now</code></p>\n</blockquote>\n<p>IPFS may occasionally run into memory problems. Our settings should prevent memory leaks (<code class=\"language-text\">HighWater</code>, <code class=\"language-text\">LowWater</code>, <code class=\"language-text\">DisableBandwidthMetrics</code>, <code class=\"language-text\">DisableNatPortMap</code>), but for now we decided to restart IPFS daemon every 24h. We use cron to accomplish the task:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">crontab</span> -e\n<span class=\"token comment\"># add the following line to the config and save</span>\n<span class=\"token number\">0</span> <span class=\"token number\">1</span> * * * <span class=\"token function\">sudo</span> systemctl restart ipfs-daemon.service</code></pre></div>\n<p>Finally, in order to get the content resolving faster, we experiment with keeping our Identity Boxes connected in a Swarm.\nIf you want to learn more about, there is a good article: <a href=\"https://medium.com/pinata/how-to-keep-your-ipfs-nodes-connected-and-ensure-fast-content-discovery-7d92fb23da46\">How to Keep Your IPFS Nodes Connected to Ensure Fast Content Discovery</a>.</p>\n<p>We first create a small bash script in <code class=\"language-text\">$HOME</code> named <code class=\"language-text\">keep-swarm-connected.sh</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token assign-left variable\">IPFS</span><span class=\"token operator\">=</span>/usr/local/bin/ipfs\n\n<span class=\"token variable\">$IPFS</span> swarm connect /ip4/35.180.235.71/tcp/4001/ipfs/QmabRgVvHEwweh9tUfCRnB6qqrB5GpLurE6zSQFxEqkjEq</code></pre></div>\n<p>Make sure that the script is executable:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">chmod</span> <span class=\"token number\">755</span> keep-swarm-connected.sh</code></pre></div>\n<p>We will be maintaining connection to our Virtual Identity Box that runs on AWS and <code class=\"language-text\">/ip4/35.180.235.71/tcp/4001/ipfs/QmabRgVvHEwweh9tUfCRnB6qqrB5GpLurE6zSQFxEqkjEq</code> is its multiaddress.</p>\n<p>Then we create a service, which will be triggered every minute in order to keep the connection active.\nWe create file <code class=\"language-text\">sudo nano /lib/systemd/system/swarm-connector.service</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>Unit<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">Description</span><span class=\"token operator\">=</span>IPFS Swarm Connector <span class=\"token function\">service</span>\n\n<span class=\"token punctuation\">[</span>Service<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">User</span><span class=\"token operator\">=</span>pi\n<span class=\"token assign-left variable\">Group</span><span class=\"token operator\">=</span>pi\n<span class=\"token assign-left variable\">Type</span><span class=\"token operator\">=</span>simple\n<span class=\"token assign-left variable\">Environment</span><span class=\"token operator\">=</span>IPFS_PATH<span class=\"token operator\">=</span>/home/pi/.ipfs\n<span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/home/pi/keep-swarm-connected.sh</code></pre></div>\n<p>and a timer file <code class=\"language-text\">sudo nano /lib/systemd/system/swarm-connector.timer</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>Unit<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">Description</span><span class=\"token operator\">=</span>Timer that periodically triggers swarm-connector.service\n<span class=\"token punctuation\">[</span>Timer<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">OnBootSec</span><span class=\"token operator\">=</span>3min\n<span class=\"token assign-left variable\">OnUnitActiveSec</span><span class=\"token operator\">=</span>1min\n<span class=\"token punctuation\">[</span>Install<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">WantedBy</span><span class=\"token operator\">=</span>timers.target</code></pre></div>\n<p>Now, enable and start the timer:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> systemctl <span class=\"token builtin class-name\">enable</span> swarm-connector.timer\n$ <span class=\"token function\">sudo</span> systemctl start swarm-connector.timer</code></pre></div>\n<p>You can check the current timer status by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ systemctl list-timers</code></pre></div>\n<p>and to see the status of its last execution:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ systemctl status swarm-connector</code></pre></div>\n<p>Our virtual identity box also keeps the same kind of connection with other Identity Boxes.</p>\n<blockquote>\n<p>We still explore. We do not know how many connections we will have to keep alive. We also consider creating a proper Identity Box service with more intelligence to keep connected what needs to be connected.</p>\n</blockquote>\n<h2 id=\"pm2\" style=\"position:relative;\"><a href=\"#pm2\" aria-label=\"pm2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PM2</h2>\n<p>We control Identity Box services using <a href=\"https://pm2.keymetrics.io/\">pm2</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> pm2 -g</code></pre></div>\n<p>In order to prevent that the logs grow without control, please add the <code class=\"language-text\">pm2-logrotate</code> module to pm2:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pm2 <span class=\"token function\">install</span> pm2-logrotate\n$ pm2 <span class=\"token builtin class-name\">set</span> pm2-logrotate:workerInterval <span class=\"token number\">300</span></code></pre></div>\n<p>The last command above sets the interval at which the logs will be checked to 5min.\nTo learn more about pm2-logrotate, please consult <a href=\"https://www.npmjs.com/package/pm2-logrotate\">https://www.npmjs.com/package/pm2-logrotate</a>.</p>\n<h2 id=\"box-office\" style=\"position:relative;\"><a href=\"#box-office\" aria-label=\"box office permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Box Office</h2>\n<p>Finally, we install and start the Box Office service:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ npx github:/identity-box/cli install-service box-office</code></pre></div>\n<p>We start the Box Office service with pm2:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ~/idbox/box-office\n$ pm2 start ecosystem.config.js</code></pre></div>\n<h2 id=\"name-service\" style=\"position:relative;\"><a href=\"#name-service\" aria-label=\"name service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Name service</h2>\n<p>To instal Name Service, please use the following commands:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ npx github:/identity-box/cli install-service nameservice</code></pre></div>\n<p>After this start the Name Service using pm2:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ~/idbox/nameservice\n$ pm2 start ecosystem.config.js</code></pre></div>\n<h2 id=\"identity-service\" style=\"position:relative;\"><a href=\"#identity-service\" aria-label=\"identity service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Identity Service</h2>\n<p>Another step is to install and start the Identity Service.</p>\n<p>First please make sure the the following environment variables are defined:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">IDBOX_BACKUP</span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/backups\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">IDBOX_BACKUP_PASSWORD</span><span class=\"token operator\">=</span>password</code></pre></div>\n<p>Please also ensure that the <code class=\"language-text\">backups</code> folder exists. It does not have to be named <code class=\"language-text\">backups</code> - any name will do,\nas long as it is there and the <code class=\"language-text\">IDBOX_BACKUP</code> variable correctly points to it. You can also set\n<code class=\"language-text\">IDBOX_BACKUP_PASSWORD</code> to whatever value you want.</p>\n<blockquote>\n<p>After changing the contents of <code class=\"language-text\">~/.bash_profile</code>, make sure you source it or re-login.</p>\n</blockquote>\n<p>This makes the environment ready to actually install the Identity Service:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ npx github:/identity-box/cli install-service identity-service</code></pre></div>\n<p>We start Identity Service with pm2:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ~/idbox/identity-service\n$ pm2 start ecosystem.config.js</code></pre></div>\n<h2 id=\"rendezvous\" style=\"position:relative;\"><a href=\"#rendezvous\" aria-label=\"rendezvous permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rendezvous</h2>\n<p>The Rendezvous service provides external connectivity to the box and this needs a bit more setup.</p>\n<p>We start with:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ npx github:/identity-box/cli install-service rendezvous</code></pre></div>\n<p>Then, we open <code class=\"language-text\">ecosystem.config.js</code> and change the <code class=\"language-text\">args</code> parameter to include the external domain name\nto be used as your rendezvous url:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token literal-property property\">args</span><span class=\"token operator\">:</span> <span class=\"token string\">'start -b https://&lt;your-domain-name>'</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>You need to register (buy) a domain name you want to use and make sure you have an <code class=\"language-text\">A</code> record pointing to your\nIP address. You also have to make sure your router is configured appropriately so that the correct ports are open\nand mapped to your identity box. If you do not want to buy a domain name yet or your IP address changes often,\nyou can try using services <a href=\"http://noip.com/\">http://noip.com/</a> or your preferred DynamicDNS solution.\nIn the end, you need to have a url that resolves to your Identity Box.</p>\n<blockquote>\n<p>Yes, this is all impossible to do for a regular user, but if you are reading this, you must know what you are doing.\nWe work hard to make this experience painless for the regular users that will decide to acquire the box from us.</p>\n</blockquote>\n<p>You will also need a <em>reverse-proxy</em> server to point this url to your rendezvous service on the box.\nIf you use <a href=\"https://www.nginx.com\">NGINX</a> (<code class=\"language-text\">sudo apt-get install nginx</code>) you can use the following configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">server {\n        listen 80;\n        server_name &lt;your-domain-url>;\n        return 301 https://$host$request_uri;\n}\n\nserver {\n        listen 443 ssl;\n        server_name &lt;your-domain-url>;\n        ssl_certificate /etc/letsencrypt/live/&lt;your-domain>/fullchain.pem;\n        ssl_certificate_key /etc/letsencrypt/live/&lt;your-domain>/privkey.pem;\n\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n        ssl_prefer_server_ciphers on;\n        ssl_ciphers 'EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH';\n        location /  {\n                proxy_pass    http://localhost:3100;\n                proxy_http_version 1.1;\n                proxy_set_header Upgrade $http_upgrade;\n                proxy_set_header Connection 'upgrade';\n                proxy_set_header Host $host;\n                proxy_cache_bypass $http_upgrade;\n        }\n}</code></pre></div>\n<blockquote>\n<p>To setup the SSL certificates, please check\n<a href=\"https://idbox.online/developers/contributing#manual-lets-encrypt-certificates\">Manual Let's Encrypt certificates</a>.</p>\n</blockquote>\n<p>Save this file as, for instance, <code class=\"language-text\">/etc/nginx/sites-available/idbox</code>, and then do:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> /etc/nginx/sites-enabled/\n$ <span class=\"token function\">sudo</span> <span class=\"token function\">ln</span> -s /etc/nginx/sites-available/idbox idbox</code></pre></div>\n<p>so that you get:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">ls</span> -l\ntotal <span class=\"token number\">0</span>\nlrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">32</span> Jun  <span class=\"token number\">6</span> <span class=\"token number\">23</span>:39 idbox -<span class=\"token operator\">></span> /etc/nginx/sites-available/idbox</code></pre></div>\n<p>Then, restart the nginx service:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> systemctl restart nginx</code></pre></div>\n<blockquote>\n<p>If you are getting an error like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">● nginx.service - A high performance web server and a reverse proxy server\n  Loaded: loaded <span class=\"token punctuation\">(</span>/lib/systemd/system/nginx.service<span class=\"token punctuation\">;</span> enabled<span class=\"token punctuation\">;</span> vendor preset: enabled<span class=\"token punctuation\">)</span>\n  Active: failed <span class=\"token punctuation\">(</span>Result: exit-code<span class=\"token punctuation\">)</span> since Fri <span class=\"token number\">2022</span>-01-14 06:03:36 CET<span class=\"token punctuation\">;</span> 22s ago\n    Docs: man:nginx<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n Process: <span class=\"token number\">6900</span> <span class=\"token assign-left variable\">ExecStartPre</span><span class=\"token operator\">=</span>/usr/sbin/nginx -t -q -g daemon on<span class=\"token punctuation\">;</span> master_process on<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>/FAILURE<span class=\"token punctuation\">)</span>\n\nJan <span class=\"token number\">14</span> 06:03:35 idbox-1-new systemd<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>: Starting A high performance web server and a reverse proxy server<span class=\"token punctuation\">..</span>.\nJan <span class=\"token number\">14</span> 06:03:36 idbox-1-new nginx<span class=\"token punctuation\">[</span><span class=\"token number\">6900</span><span class=\"token punctuation\">]</span>: nginx: <span class=\"token punctuation\">[</span>emerg<span class=\"token punctuation\">]</span> could not build server_names_hash, you should increase server_names_hash_bucket_size: <span class=\"token number\">32</span>\nJan <span class=\"token number\">14</span> 06:03:36 idbox-1-new nginx<span class=\"token punctuation\">[</span><span class=\"token number\">6900</span><span class=\"token punctuation\">]</span>: nginx: configuration <span class=\"token function\">file</span> /etc/nginx/nginx.conf <span class=\"token builtin class-name\">test</span> failed\nJan <span class=\"token number\">14</span> 06:03:36 idbox-1-new systemd<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>: nginx.service: Control process exited, <span class=\"token assign-left variable\">code</span><span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>/FAILURE\nJan <span class=\"token number\">14</span> 06:03:36 idbox-1-new systemd<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>: nginx.service: Failed with result <span class=\"token string\">'exit-code'</span><span class=\"token builtin class-name\">.</span>\nJan <span class=\"token number\">14</span> 06:03:36 idbox-1-new systemd<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>: Failed to start A high performance web server and a reverse proxy server.</code></pre></div>\n<p>you may need to update your <code class=\"language-text\">/etc/nginx/nginx.conf</code> file and make sure that line:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">server_names_hash_bucket_size <span class=\"token number\">64</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>is <strong>not</strong> commented out.</p>\n</blockquote>\n<p>Finally, start the Rendezvous service:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ~/idbox/rendezvous\n$ pm2 start ecosystem.config.js</code></pre></div>\n<p>At this point your Identity Box should be correctly set up and you can start experimenting with it.</p>\n<h2 id=\"running-services-as-a-daemon\" style=\"position:relative;\"><a href=\"#running-services-as-a-daemon\" aria-label=\"running services as a daemon permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Running services as a daemon</h2>\n<p>To make pm2 running as daemon:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pm2 startup\n<span class=\"token comment\"># this will give you a command that you have to copy and paste in the terminal and execute it, something like:</span>\n<span class=\"token punctuation\">[</span>PM2<span class=\"token punctuation\">]</span> Init System found: systemd\n<span class=\"token punctuation\">[</span>PM2<span class=\"token punctuation\">]</span> To setup the Startup Script, copy/paste the following command:\n<span class=\"token function\">sudo</span> <span class=\"token function\">env</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span>:/home/pi/.nvm/versions/node/v12.14.1/bin /home/pi/.config/yarn/global/node_modules/pm2/bin/pm2 startup systemd -u pi --hp /home/pi</code></pre></div>\n<p>Finally to freeze a process list on reboot run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pm2 save</code></pre></div>\n<p>You can remove startup script at any time by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ pm2 unstartup systemd</code></pre></div>\n<h2 id=\"upgrading-identity-box-services\" style=\"position:relative;\"><a href=\"#upgrading-identity-box-services\" aria-label=\"upgrading identity box services permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Upgrading Identity Box Services</h2>\n<p>For each service follow the steps (we use <code class=\"language-text\">box-office</code> below as an example):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> ~/idbox/box-office\n$ <span class=\"token function\">yarn</span> up @identity-box/box-office\n$ pm2 reload ecosystem.config.js</code></pre></div>\n<p>Do the same for each single servic replacing <code class=\"language-text\">box-office</code> with the appropriate package name.</p>\n<h2 id=\"appendix---ipns-with-firebase\" style=\"position:relative;\"><a href=\"#appendix---ipns-with-firebase\" aria-label=\"appendix   ipns with firebase permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Appendix - IPNS with Firebase</h2>\n<p>Until recently, we used Firebase to <em>fake</em> IPNS name resolution (a temporary solution to IPNS resolution problems).\nWe currently experiment with using native IPFS <em>pubsub</em> functionality to secure reliable and fast name resolution\nwithout resorting to external, centralized services.</p>\n<p>The last version of <code class=\"language-text\">@identity-box/idservice</code> that uses Firebase is <code class=\"language-text\">0.1.23</code>.</p>\n<p>Because it uses Admin access (just for simplicity) this means, that if you want to build your own\nIdentity Box, you need to have Admin access to our Firebase Project.\nObviously, we need to change that.</p>\n<p>To have Firebase working, we need to upload the <code class=\"language-text\">idbox-firebase.json</code> file to your Raspberry Pi.\nThis file currently available to (trusted) contributors only and can be found on our Identity Box\nKeybase team share.</p>\n<p>Once you have the file on your Raspberry Pi, you need to add the following to <code class=\"language-text\">.bash_profile</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">GOOGLE_APPLICATION_CREDENTIALS</span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/idbox-firebase.json</code></pre></div>\n<p>Please make sure that the path to the <code class=\"language-text\">idbox-firebase.json</code> file is correct.</p>","fileAbsolutePath":"/home/runner/work/identity-box/identity-box/workspaces/homepage/src/pages/developers/SettingUpIdentityBoxOnRaspberryPi.md","frontmatter":{"title":"Identity Box on Raspberry Pi","content":null}},"mdx":null},"pageContext":{}},"staticQueryHashes":["1136224994"]}